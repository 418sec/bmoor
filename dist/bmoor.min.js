;(function(){
/** bmoor v0.2.0 **/
var bMoor={};!function(t){"use strict";function e(){}function n(){return++dt}function r(t){var e=t.$$bmoorUid;return e||(e=t.$$bmoorUid=n()),e}function o(t){return t.$$bmoorUid}function i(t){return t?x(t)?t.split("."):bt(t)?t.slice(0):t:[]}function s(t,n,r){var o,s,u,c=r||ft;if(t&&(x(t)||P(t))){t=i(t),s=t.pop();for(var a=0;a<t.length;a++)u=t[a],j(c[u])&&(c[u]=new e),c=c[u];o=c[s],c[s]=n,E(o)&&o._$deferred&&o(n)}return o}function u(t,e){var n,r,o,s=e||bMoor.namespace.root;if(t&&(x(t)||P(t))){t=i(t),r=t.pop();for(var u=0;u<t.length;u++){if(o=t[u],j(s[o]))return;s=s[o]}n=s[r],delete s[r]}return n}function c(t,n){var r,o=n||bMoor.namespace.root;if(t&&(x(t)||P(t))){t=i(t);for(var s=0;s<t.length;s++)r=t[s],j(o[r])&&(o[r]=new e),o=o[r];return o}if(I(t))return t;if(E(t))return t(n);throw new Error("unsupported type")}function a(t,e){var n=e||bMoor.namespace.root;if(x(t)||P(t)){t=i(t);for(var r=0;r<t.length;r++){var o=t[r];if(j(n[o]))return;n=n[o]}return n}if(I(t))return t;throw new Error("unsupported type")}function f(t,e){var n,r,o;if(P(e)&&e.length>0){for(n=0,r=e.length;r>n&&!o;n++)o=a(t,e[n]);return o}return a(t,e)}function l(t,e,n){var r;n?(n.$aliases||(n.$aliases={}),r=n.$aliases):r=pt,r[t]=e}function h(t,e){var n;return e?(e.$aliases||(e.$aliases={}),n=e.$aliases):n=pt,n[t]}function d(t,e){s(t,e,bMoor)}function p(t,e,n){var r,o,i;if(x(t)&&(t=c(t,n)),i="return new obj(",arguments.length>1)for(r=0,o=e.length;o>r;r++)r&&(i+=","),i+="args["+r+"]";return i+=")",new Function("obj","args",i)(t,e)}function b(t,e){return L(e,function(e,n){s(n,e,t)}),t}function m(t){return t.prototype&&(t=t.prototype),g(t)}function g(t){if(Object.create){var e=function(){};return e.prototype=t,new e}return Object.create(t)}function M(t){return R(arguments,function(e){e!==t&&(t&&t.extend?t.extend(e):L(e,function(e,n){t[n]=e}))}),t}function v(t){var e,n,r,o=function(e,n){t[n]=v(t[n],e)};for(n=1,r=arguments.length;r>n;n++)e=arguments[n],t!==e&&e&&(t&&t.merge?t.merge(e):I(t)?B(e,o):t=I(e)?v({},e):e);return t}function y(t,e,n){return B(e,function(e,r){var o=t[r];void 0===o&&(!n||e&&e.$constructor)?t[r]=e:bMoor.isArrayLike(e)?(bMoor.isArrayLike(o)||(o=t[r]=[]),w(o,e,n)):bMoor.isObject(e)?(bMoor.isObject(o)||(o=t[r]={}),y(o,e,n)):e!==o&&(t[r]=e)}),B(t,function(n,r){void 0===e[r]&&delete t[r]}),t}function w(t,e,n){var r,o,i,s;for(P(t)&&P(e)&&(t.length=e.length),r=0,o=e.length;o>r;r++)i=e[r],s=t[r],void 0!==s||n?bMoor.isArrayLike(i)?(bMoor.isArrayLike(s)||(s=t[r]=[]),w(s,i,n)):bMoor.isObject(i)?(bMoor.isObject(s)||(s=t[r]={}),y(s,i,n)):i!==s&&(t[r]=i):t[r]=i;return t}function k(t,e){var n,r,o,i=typeof t,s=typeof e;if(t===e)return!0;if(t!==t&&e!==e)return!0;if(null===t||void 0===t||null===e||void 0===e)return!1;if(t.equals)return t.equals(e);if(e.equals)return e.equals(t);if(i===s&&"object"===i)if(P(t)){if(!P(e))return!1;if((n=t.length)===e.length){for(r=0;n>r;r++)if(!k(t[r],e[r]))return!1;return!0}}else if(!P(e)){o={};for(r in t)if(t.hasOwnProperty(r)){if(!k(t[r],e[r]))return!1;o[r]=!0}for(r in e)if(e.hasOwnProperty(r)&&!o&&void 0!==e[r])return!1}return!1}function $(t){t.message?(console.log(t.message),console.log(t.stack)):(console.log(t),console.trace())}function j(t){return void 0===t}function _(t){return void 0!==t}function x(t){return"string"==typeof t}function A(t){return"number"==typeof t}function E(t){return"function"==typeof t}function I(t){return t&&"object"==typeof t}function O(t){return"boolean"==typeof t}function P(t){return t?I(t)&&(0===t.length||0 in t&&t.length-1 in t):!1}function q(t){return"function"==typeof t&&t.$isQuark}function N(t){var e;if(!I(t))return P(t)?0===t.length:j(t);for(e in t)if(t.hasOwnProperty(e))return!1;return!0}function F(t){return I(t)&&void 0!==t.then}function S(t){return bt(t)&&E(t[t.length-1])}function C(t,e){return S(t)?t:E(t)?e?[function(){return t}]:[t]:_(t)?[function(){return t}]:void 0}function R(t,e,n){var r,o;for(n||(n=t),r=0,o=t.length;o>r;++r)r in t&&e.call(n,t[r],r,t)}function Q(t,e,n){var r;n||(n=t);for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function L(t,e,n){var r;n||(n=t);for(r in t)t.hasOwnProperty(r)&&"_"!==r.charAt(0)&&e.call(n,t[r],r,t)}function B(t,e,n){var r;n||(n=t);for(r in t)t.hasOwnProperty(r)&&"_"!==r.charAt(0)&&"$"!==r.charAt(0)&&e.call(n,t[r],r,t)}function U(t,e,n){B(t,function(t,r,o){E(t)||e.call(n,t,r,o)})}function D(t,e,n){t&&(t.forEach&&t.forEach!==D?t.forEach(e,n):P(t)?R(t,e,n):E(t)?L(t,e,n):Q(t,e,n))}function J(t){var e;return I(t)&&t.then?t:(e=new st,e.resolve(t),e.promise)}function T(t){var e;return e=new st,e.reject(t),e.promise}function z(t,e){var n,r,o=f(t,e);return o?J(o):(n=new st,r=function(t){n.resolve(t)},r._$deferred=n.promise,bMoor.set(t,r,e),n.promise)}function G(t,e){var n=[];return R(t,function(t,r){n[r]=bMoor.ensure(t,e)}),n}function H(t,e,n){var r;return x(t)?bMoor.ensure(t,n):P(t)?(r=new ut,R(t,function(o,i){e&&x(o)&&(o=bMoor.ensure(o,n)),F(o)?(o.then(function(e){t[i]=e}),r.add(o)):t[i]=o}),r.run(),r.promise.then(function(){return t})):void 0}function W(t,e,n){var r=W.getInjections(t),o=W.getMethod(t);return n||(n=bMoor),H(G(r,e),!1,e).then(function(t){return o.apply(n,t)})}function Y(t,e,n){var r,o,i=W.getMethod(t),s=W.getInjections(t),u=[];for(n||(n=bMoor),r=0,o=s.length;o>r;r++)u.push(bMoor.makeReady(s[r],e));return i.apply(n,u)}function K(t,e,n){var r,o,i,s,u=W.getMethod(t),c=W.getInjections(t),a=[];for(n||(n=bMoor),r=0,o=c.length;o>r;r++)s=c[r],i=s.charAt(0),"@"===i?a.push(h(s.substr(1),e)):("-"===i&&(s=s.substr(1)),a.push(f(s,e)));return u.apply(n,a)}function V(t){var e=t,n=document.createElement("a");return lt&&(n.setAttribute("href",e),e=n.href),n.setAttribute("href",e),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}function X(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t,e,n){if(t.indexOf)return t.indexOf(e,n);var r=parseInt(t.length,0);for(n=+n||0,Math.abs(n)===1/0&&(n=0),0>n&&(n+=r,0>n&&(n=0));r>n;n++)if(t[n]===e)return n;return-1}function tt(t,e,n){var r=Z(t,e,n);return r>-1?t.splice(r,1)[0]:void 0}function et(t,e,n){var r,o=Z(t,e,n);return o>-1?(r=et(t,e,o+1),r.unshift(t.splice(o,1)[0]),r):[]}function nt(t,e,n,r){var o,i,s=0,u=t.length-1;if(r||t.sort(function(t,e){return n(t)-n(e)}),n(t[s])>=e)return{left:s,right:s};if(n(t[u])<=e)return{left:u,right:u};if(t.length){for(;u-s>1;)o=Math.floor((u+s)/2),i=n(t[o]),i===e?(u=o,s=o):i>e?u=o:s=o;return u!==o&&n(t[u])===e?{left:u,right:u}:s!==o&&n(t[s])===e?{left:s,right:s}:{left:s,right:u}}}function rt(t,e,n){if(t.filter)return t.filter(e,n);var r,o,i=Object(this),s=parseInt(i.length,10),u=[];if(!E(e))throw new Error("func needs to be a function");for(r=0;s>r;r++)r in i&&(o=i[r],e.call(n,o,r,i)&&u.push(o));return u}function ot(t,e,n){var r,o=[],i=[],s=[],u=[];for(t=t.slice(0),e=e.slice(0),t.sort(n),e.sort(n);t.length>0&&e.length>0;)r=n(t[0],e[0]),0>r?o.push(t.shift()):r>0?i.push(e.shift()):(s.push(t.shift()),u.push(e.shift()));for(;t.length;)o.push(t.shift());for(;e.length;)i.push(e.shift());return{left:o,intersection:{left:s,right:u},right:i}}function it(t){this.defer=t}function st(t){this.handler=t||this.defaultHandler,this.callbacks=[],this.value=null,this.promise=new it(this)}function ut(){this.count=0,this.loaded=!1,this.errors=[],this.defer=new st,this.promise=this.defer.promise}function ct(t){var e=[];return U(t,function(t){e.push(t)}),e}function at(t){var e=[];return U(t,function(t,n){e.push(n)}),e}var ft,lt,ht,dt=0,pt={};t.navigator?(t.bMoor=bMoor,lt=parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1],10),isNaN(lt)&&(lt=parseInt((/trident\/.*; rv:(\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1],10)),ht={isNode:!1,msie:lt}):(module.exports=bMoor,ht={isNode:!0}),e.prototype.$clone=function(t,n){var r=new e;return n?s(t,r,n):n=r,t?t+=".":t="",B(this,function(o,i){o instanceof e?o.$clone(t+i,n):bMoor.isQuark(o)?o.clone(t+i,n):r[i]=o}),r},ft=new e;var bt=function(t){return t instanceof Array};W.getMethod=function(t){if(S(t))return t[t.length-1];if(E(t))return t;throw new Error("inject needs arr to be either Injectable or Function, received:"+typeof t)},W.getInjections=function(t){return S(t)?t.slice(0,-1):[]},l("undefined",void 0),s("bmoor.defer.Promise",it),M(it.prototype,{then:function(t,e){function n(e){try{i.resolve((t||o.defaultSuccess).call(i,e))}catch(n){i.reject(n),o.handler(n)}}function r(t){try{i.resolve((e||o.defaultFailure).call(i,t))}catch(n){i.reject(n),o.handler(n)}}var o=this.defer,i=this.defer.sub();return o.register(n,r),i.promise},"catch":function(t){return this.then(null,t)},done:function(t){return this.then(t),this},fail:function(t){return this.then(null,t),this},"finally":function(t){function e(t,e){var n=new st;return e?n.resolve(t):n.reject(t),n.promise}function n(n,o){var i=null;try{i=(t||r.defaultSuccess)()}catch(s){return e(s,!1)}return i&&bMoor.isFunction(i.then)?i.then(function(){return e(n,o)},function(t){return e(t,!1)}):e(n,o)}var r=this;return this.then(function(t){return n(t,!0)},function(t){return n(t,!1)})},always:function(t){return this["finally"](t),this}}),s("bmoor.defer.Basic",st),function(){function t(t){return t&&t.then?t:{then:function(e){bMoor.isArrayLike(t)&&t.$inject?e.apply(void 0,t):e(t)}}}function e(t){return{then:function(e,n){n(t)}}}M(st.prototype,{defaultHandler:function(t){bMoor.error.report(t)},defaultSuccess:function(t){this.resolve(t)},defaultFailure:function(t){this.reject(t)},register:function(t,e){this.callbacks?this.callbacks.push([t,e]):this.value.then(t,e)},resolve:function(e){var n,r,o,i;if(this.callbacks)for(n=this.callbacks,this.callbacks=null,this.value=t(e),o=0,i=n.length;i>o;o++)r=n[o],this.value.then(r[0],r[1])},reject:function(t){this.resolve(e(t))},sub:function(){return new st(this.handler)}})}(),s("bmoor.defer.Group",ut),function(){function t(t){0===t.count&&t.loaded&&(t.errors.length?t.defer.reject(t.errors):t.defer.resolve(!0))}function e(e){e.count--,t(e)}M(ut.prototype,{add:function(t){var n=this;t&&(this.count++,t.then(function(){e(n)},function(t){n.errors.push(t),e(n)}))},run:function(){this.loaded=!0,t(this)}})}(),s("bmoor.defer.all",function(){var t,e=new ut;return t=A(arguments[0].length)?arguments[0]:arguments,bMoor.forEach(t,function(t){e.add(t)}),e.run(),e.promise}),M(bMoor,{namespace:{root:ft},parseNS:i,dwrap:J,dfail:T,set:s,get:c,del:u,exists:f,register:l,check:h,ensure:z,request:H,translate:G,inject:W,invoke:Y,decode:K,plugin:d,loop:R,each:Q,iterate:L,forEach:D,isBoolean:O,isDefined:_,isUndefined:j,isArray:bt,isArrayLike:P,isObject:I,isFunction:E,isNumber:A,isString:x,isEmpty:N,isQuark:q,isInjectable:S,makeInjectable:C,makeNav:function(){return new e},data:{setUid:r,getUid:o},object:{safe:B,naked:U,mask:g,equals:k,inherit:m,instantiate:p,extend:M,merge:v,override:y,explode:b,values:ct,keys:at},string:{trim:X},array:{compare:ot,indexOf:Z,remove:tt,removeAll:et,filter:rt,override:w,bisect:nt},error:{report:$},url:{resolve:V}})}(this),bMoor.inject(["bmoor.defer.Basic","bmoor.build.Quark",function(t,e){"use strict";function n(){}function r(t,e){var r;if(bMoor.isObject(e))return e["abstract"]?(r=function(){throw new Error("You tried to instantiate an abstract class")},r.prototype=new n):r=e.construct?e.construct:function(){return!bMoor.isFunction(e.parent)||e.parent.prototype instanceof n?void 0:e.parent.apply(this,arguments)},t.clean||(t.preProcess.sort(function(t,e){return e.rank-t.rank}),t.postProcess.sort(function(t,e){return e.rank-t.rank}),t.clean=!0),e.$aliases={constructor:r},bMoor.loop(t.preProcess,function(t){r=bMoor.decode(t.module,e,r,!0)||r}),bMoor.loop(t.postProcess,function(t){r=bMoor.decode(t.module,e,r,!0)||r}),r;throw new Error("Constructor has no idea how to handle as definition of "+e)}function o(t,e,n){var r,i,s,u,c=t.makes[e];if(c)s="make";else{if(c=t.defines[e],!c)throw new Error("could not redeclair: "+e+"\nmakes("+Object.keys(t.makes)+")\ndefines("+Object.keys(t.defines)+")");s="define"}if(u=bMoor.get(e,t.root),u.$$lock!==n){for(r=0,i=c.length-1;i>r;r++)c[r]!==e&&o(t,c[r],n);bMoor.del(e,t.root),t[s](e,c,t.root),bMoor.get(e,t.root).$$lock=n}}function i(t,n,r){var o=t.root;bMoor.iterate(n,function(t,n){var i=bMoor.get(n,o);i instanceof e&&(i=i.$instantiate()),i.$$lock=r,bMoor.set(t,i,o)})}var s,u=function(){this.preProcess=[],this.postProcess=[],this.defines={},this.clean=!0,this.makes={},this.root=bMoor.namespace.root};u.prototype.clone=function(){var t=new u;return t.postProcess=bMoor.object.extend([],this.postProcess),t.preProcess=bMoor.object.extend([],this.preProcess),t.clean=this.clean,t.defines={},bMoor.object.safe(this.defines,function(e,n){t.defines[n]=e.slice(0)}),t.makes={},bMoor.object.safe(this.makes,function(e,n){t.makes[n]=e.slice(0)}),t.root=this.root.$clone(),t},bMoor.plugin("isAbstract",function(t){return t instanceof n}),u.prototype.newRoot=function(){return this.root=bMoor.makeNav(),this.root},u.prototype.addModule=function(t,e,n){t=parseInt(t,10),this.clean=!1,arguments.length<3?n=e:bMoor.set(e,n[n.length-1],this.root),t>=0?this.preProcess.push({rank:t,module:n}):this.postProcess.push({rank:t,module:n})},u.prototype.make=function(t,n,o){var i,s,u,c=this;if(!bMoor.isString(t))throw new Error(JSON.stringify(t)+" > "+JSON.stringify(n)+" > message : you need to define a name and needs to be either a string or an array");return u=e.create(t,o||this.root),bMoor.isInjectable(n)?(s=n[n.length-1],s._$raw&&(s=s._$raw),i=n):(s=bMoor.isFunction(n)?n:function(){return n},i=[s]),i[i.length-1]=function(){return r(c,s.apply(null,arguments))},i[i.length-1]._$raw=s,this.makes[t]=i,u.$setInjection(i),u},u.prototype.define=function(t,n,r){var o,i;if(!bMoor.isString(t))throw new Error(JSON.stringify(t)+" > "+JSON.stringify(n)+" > message : you need to define a name and needs to be either a string");return i=e.create(t,r||this.root),o=bMoor.isInjectable(n)?n:[function(){return n}],this.defines[t]=o,i.$setInjection(o),i},u.prototype.mock=function(t,e){return this.make("",this.makes[t],bMoor.object.extend({},this.root,e))},s=new u,s.$constructor=u,bMoor.set("bmoor.build.Compiler",s),bMoor.plugin("make",function(t,e){return s.make(t,e)}),bMoor.plugin("define",function(t,e){return s.define(t,e)});var c=1;bMoor.plugin("test",{clone:function(){return s.clone()},debug:function(t){console.log("clone",t,bMoor.exists(t,s.clone().root)),console.log("primary",t,bMoor.exists(t,s.root))},injector:function(t,e){return function(){var n=s.clone(),r=c++;e&&(i(n,e,r),bMoor.iterate(bMoor.inject.getInjections(t),function(t){o(n,t,r)})),bMoor.inject(t,n.root)}},make:function(t){return s.make("",t).$instantiate()},mock:function(t,e){var n;return s.mock(t,bMoor.object.explode(e)).then(function(t){n=t}),n}})}]),bMoor.inject(["bmoor.defer.Group","bmoor.defer.Basic",function(t,e){"use strict";function n(t,e){var n=t.join(".");this.getPath=function(){return t},this.getRoot=function(){return e},this.getName=function(){return n},t.length&&bMoor.set(t,this,e)}n.create=function(t,e){var r;return""!==t?(t=bMoor.parseNS(t),r=bMoor.get(t,e)):t=[],r instanceof n||(r=new n(t,e)),r},n.prototype.clone=function(t,e){var r=n.create(t,e);return this._injection&&r.$setInjection(this._injection),r},n.prototype.$instantiate=function(){var t,n=this.getPath(),r=this.getRoot();return this._injection?(t=bMoor.invoke(this._injection,r),this.$$lock&&(t.$$lock=this.$$lock),n.length&&bMoor.set(n,t,r),this._waiting&&this._waiting.resolve(t),t):(this._waiting||(this._waiting=new e),this._waiting.promise)},n.prototype.$reqs=function(t,e){var n,r,o,i=this._requirements,s=!0;for(n=0,r=i.length;r>n&&s;n++)o=bMoor.exists(i[n],e),s=t.call(void 0,o,i[n]);return s},n.prototype.$setInjection=function(t){var e=this.getRoot(),r=this.getName(),o=[];return this._injection=t.slice(0).filter(function(t){return t!==r}),this._requirements=bMoor.inject.getInjections(this._injection),this.$reqs(function(t,r){void 0===t?(n.create(r,e),o.push(r)):bMoor.isQuark(t)&&o.push(r)},e),this._requirements=o,this._waiting&&this.$instantiate(),this},n.prototype.$warn=function(){return"attempting to use quark, which is located at "+this.getPath().join(".")},n.prototype.getRequirements=function(){return this._requirements},n.prototype.define=function(){var t=this.$reqs(function(t){return bMoor.isQuark(t)&&t.define()||!bMoor.isReady(t)},this.getRoot());if(t)return this.$instantiate();throw new Error(this.$warn())},n.prototype.load=function(){var e=this,n=new t;return this.$reqs(function(t){bMoor.isQuark(t)&&n.add(t.load())},this.getRoot()),n.run(),n.promise.then(function(){return e.$instantiate()})},bMoor.set("bmoor.build.Quark",n),bMoor.plugin("ensure",function(t,e){var r,o=bMoor.exists(t,e);return r=o?o instanceof n?o.$instantiate():o:new n(t,e).$instantiate(),bMoor.dwrap(r)}),bMoor.plugin("require",function(t,e){var r=bMoor.exists(t,e);if(r instanceof n)return r.define();if(bMoor.isDefined(r))return r;throw new Error("could not require: "+t)}),bMoor.plugin("makeReady",function(t,e){var n=bMoor.exists(t,e);if(bMoor.isQuark(n))return n.define();if(bMoor.isDefined(n))return n;throw new Error("could not make "+t+" ready")}),bMoor.plugin("isQuark",function(t){return t instanceof n})}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(11,"bmoor.build.ModExtend",["-extend",function(t){var e,n,r=this.prototype;if(t)for(e=0,n=t.length;n>e;e++)t[e]._$extend(r)}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(5,"bmoor.build.ModFactory",["-factory",function(t){var e=this;t&&bMoor.iterate(t,function(t,n){e["$"+n]=function(){return t.apply(e,arguments)}})}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(-100,"bmoor.build.ModFinalize",["-finalize",function(t){t&&t(this)}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(90,"bmoor.build.ModInherit",["-id","-namespace","-name","-mount","-parent",function(t,e,n,r,o){var i;o&&(i=this,this.prototype=bMoor.object.inherit(o),this.prototype.constructor=i,delete this.$generic)}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(-1,"bmoor.build.ModInstances",["-instances",function(t){var e=this;t&&bMoor.iterate(t,function(t,n){e["$"+n]=bMoor.instantiate(e,t)})}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(10,"bmoor.build.ModProperties",["-properties",function(t){var e=this.prototype;t&&bMoor.each(t,function(t,n){e[n]=t})}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(0,"bmoor.build.ModRegister",["-id",function(t){bMoor.register(t,this)}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(-1,"bmoor.build.ModSingleton",["-singleton",function(t){var e,n=this;return t?(e=bMoor.object.instantiate(n,[]),e.$constructor=n,e):void 0}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(10,"bmoor.build.ModStatics",["-statics",function(t){var e=this;t&&bMoor.iterate(t,function(t,n){e[n]=t})}])}]),bMoor.inject(["bmoor.build.Compiler",function(t){"use strict";t.addModule(89,"bmoor.build.ModWrapper",["-wrap",function(t){t&&(this.prototype.$wrap=function(){function e(t,e,n){t[n]=bMoor.isFunction(e)?function(){return e.apply(r,arguments)}:e}var n,r=bMoor.object.instantiate(t,arguments);this.$wrapped=r;for(n in r)n in this||e(this,r[n],n)})}])}]),bMoor.make("bmoor.defer.Stack",["bmoor.defer.Basic",function(t){"use strict";return{construct:function(){this.active=null,this.defer=new t,this.promise=this.defer.promise},properties:{run:function(){var t=this;this.active.then(function(e){t.defer.resolve(e)},function(e){t.defer.reject(e)})},add:function(t,e,n){var r=this;return this.active=this.active?this.active.then(function(){return t.apply(n,e)},function(t){r.defer.reject(t)}):bMoor.dwrap(t.apply(n,e)),this}}}}]),bMoor.make("bmoor.flow.Interval",[function(){"use strict";return{construct:function(){this.clearAll()},properties:{set:function(t,e,n){var r,o=this.timeouts[e],i=this._c++;return o||(o=this.timeouts[e]={_c:0},bMoor.testMode||(o._hk=setInterval(function(){bMoor.iterate(o,function(t){t()})},e))),r=o._c++,o[r]=function(){t.call(n)},this.hash[i]={hk:o._c,val:e},i},flush:function(){bMoor.iterate(this.timeouts,function(t){bMoor.iterate(t,function(t){t()})})},clear:function(t){var e=this.hash[t];e&&(delete this.timeouts[e.val][e.hk],delete this.hash[t])},clearAll:function(){this._c=0,this.timeouts={},this.hash={}}},singleton:!0}}]),bMoor.define("bmoor.flow.Regulator",["bmoor.flow.Timeout",function(t){"use strict";return function(e,n,r,o){function i(){var r=a+n;r>=l||r>=f?(l=null,e.apply(o,u)):(a=r,c=t.set(i,n))}function s(){var e=+new Date;u=arguments,f=e+n,l||(a=e,l=e+r,c=t.set(i,n))}var u,c,a,f,l;return s.clear=function(){t.clear(c),c=null,l=null},s.flush=function(){l=0,i(),this.clear()},s.shift=function(t){f+=t},s}}]),bMoor.make("bmoor.flow.Timeout",[function(){"use strict";return{construct:function(){},properties:{set:function(t,e,n){return setTimeout(function(){t.call(n)},e)},clear:function(t){clearTimeout(t)}},singleton:!0}}]),bMoor.make("bmoor.error.Basic",[function(t){"use strict";return{parent:Error,construct:function(e,n,r){var o,i;try{throw new Error}catch(s){i=s}this.name=this.__class,this.error=e,this.fileName=n,this.lineNumber=r,this.problem=t,i.stack&&(o=i.stack.split("\n"),"Error"===o[0]?(o.shift(),o.shift(),o.shift()):(o.pop(),o.shift(),o.shift()),this.problem=o[0],this.stack=o.join("\n")),this.message=e+"\n"+this.stack},properties:{toString:function(){return this.name+": "+this.message}}}}]),bMoor.make("bmoor.extender.Decorator",[function(){"use strict";function t(t,e,n){var r=e[t];void 0===r?e[t]=n:bMoor.isFunction(n)?bMoor.isFunction(r)?e[t]=function(){var t,e=this.$old;return this.$old=r,t=n.apply(this,arguments),this.$old=e,t}:console.log("attempting to decorate "+t+" an instance of "+typeof r):console.log("attempting to decorate with "+t+" and instance of "+typeof n)}return{"abstract":!0,properties:{_$extend:function(e){var n;for(n in this)("_"!==n.charAt(0)||"$"!==n.charAt(1))&&t(n,e,this[n])}}}}]),bMoor.make("bmoor.extender.Mixin",[function(){"use strict";return{"abstract":!0,properties:{_$extend:function(t){var e;for(e in this)("_"!==e.charAt(0)||"$"!==e.charAt(1))&&(t[e]=this[e])}}}}]),bMoor.make("bmoor.extender.Plugin",[function(){"use strict";function t(t,e,n){var r=n[t],o=e[t];void 0===o?e[t]=bMoor.isFunction(r)?function(){return r.apply(n,arguments)}:r:bMoor.isFunction(r)?bMoor.isFunction(o)?e[t]=function(){var t,i=n.$old,s=n.$target;return n.$target=e,n.$old=function(){return o.apply(e,arguments)},t=r.apply(n,arguments),n.$old=i,n.$target=s,t}:console.log("attempting to plug-n-play "+t+" an instance of "+typeof o):console.log("attempting to plug-n-play with "+t+" and instance of "+typeof r)}return{"abstract":!0,properties:{_$extend:function(e){var n;this._$onExtend&&this._$onExtend(e);for(n in this)("_"!==n.charAt(0)||"$"!==n.charAt(1))&&t(n,e,this)}}}}]);
}());