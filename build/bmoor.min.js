/*! bmoor 2014-01-31 */
!function(a,b){"use strict";function c(a){return a?p(a)?a.split("."):u(a)?a.slice(0):a:[]}function d(b,d,e){var f,g=e||a;if(b&&(p(b)||t(b))){b=c(b);for(var h=0;h<b.length;h++)f=b[h],h===b.length-1?g[f]=d:(g[f]||(g[f]={}),g=g[f])}}function e(b,d){var e,f=d||a;if(b&&(p(b)||t(b))){b=c(b);for(var g=0;g<b.length;g++)e=b[g],f[e]||(f[e]={}),f=f[e];return f}return s(b)?b:null}function f(b,d){var e=d||a;if(p(b)||t(b)){b=c(b);for(var f=0;f<b.length;f++){var g=b[f];if(!e[g])return null;e=e[g]}return e}return s(b)?b:null}function g(a,b){Q[a]=b}function h(a){return Q[a]}function i(a,c){var d;return c===b&&(d=h(u(a)?a.join("."):a))?d:f(a,c)}function j(a,b){d(a,b),g(a,b)}function k(a){console.log(a)}function l(a){return Object.prototype.toString.call(a)}function m(a){var b;return a.$defer?b=a.$defer:(b=new M,b.resolve(a)),b.promise}function n(a){return a===b}function o(a){return a!==b}function p(a){return"string"==typeof a}function q(a){return"number"==typeof a}function r(a){return"function"==typeof a}function s(a){return a&&"object"==typeof a}function t(a){return a&&"number"==typeof a.length&&(1!=a.length||a[0])}function u(a){return a&&"[object Array]"===l(a)}function v(a){a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function w(a,b,c){var d,e;for(c||(c=a),d=0,e=a.length;e>d;++d)d in a&&b.call(c,a[d],d,a)}function x(a,b,c){var d;c||(c=a);for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)}function y(a,b,c){var d;c||(c=a);for(d in a)"prototype"!==d&&"length"!==d&&"name"!==d&&a.hasOwnProperty(d)&&b.call(c,a[d],d,a)}function z(a,b,c){a&&(a.forEach&&a.forEach!==z?a.forEach(b,c):t(a)?w(a,b,c):r(a)?y(a,b,c):x(a,b,c))}function A(a){if(Object.create)return Object.create(a);var b=function(){};if(1!==arguments.length)throw new Error("create implementation only accepts one parameter.");return b.prototype=a,new b}function B(a){return w(arguments,function(b){b!==a&&x(b,function(b,c){a[c]=b})}),a}function C(a,b,c){if(a===b)return b;if(b)if(b.copy)b.copy(a);else if(t(a)){b.length=0;for(var d=0,e=a.length;e>d;d++)b.push(C(a[d]))}else x(b,function(a,c){delete b[c]}),x(a,function(a,c){b[c]=a});else b=a,a&&(b=a.clone?a.clone():t(a)?C(a,[],c):C(a,{},c));return b}function D(a,c){var d,e,f,g=typeof a,h=typeof c;if(a===c)return!0;if(a!==a&&c!==c)return!0;if(null===a||a===b||null===c||null===c)return!1;if(a.equals)return a.equals(c);if(c.equals)return c.equals(a);if(g===h&&"object"===g)if(t(a)){if(!t(c))return!1;if((d=a.length)===c.length){for(e=0;d>e;e++)if(!D(a[e],c[e]))return!1;return!0}}else if(!t(c)){f={};for(e in a)if(a.hasOwnProperty(e)){if(!D(a[e],c[e]))return!1;f[e]=!0}for(e in c)if(c.hasOwnProperty(e)&&!f&&c[e]!==b)return!1}return!1}function E(a,b){function c(a){this._construct&&c.$construct&&(a&&a.$arguments?this._construct.apply(this,a):this._construct.apply(this,arguments))}return b&&(c.$defer=new M),c.$construct=!0,c.prototype.__class=a,d(a,c),c}function F(a,b){var c;return c=i(a),c?c:E(a,!b)}function G(a,b){var c,d;if(p(a))return d=F(a,b),d.$defer?d.$defer.promise:m(d);if(t(a))return c=new N,d=[],d.$inject,w(a,function(a,e){var f;f=F(a,b),f.$defer&&c.add(f.$defer.promise),d[e]=f}),c.promise.then(function(){return d});throw{message:"Request needs a string or array passed in"}}function H(a,b){var c=[];return w(a,function(a,d){c[d]=f(a,b)}),c}function I(a,b,c){var d,e;if(r(a))d=a,a=[];else{if(!u(a))throw"inject needs arr to be either Array or Function";d=a.pop()}return e=H(a,b),a.push(d),d.apply(c,e)}function J(a,b){d(a,b,O)}function K(a){var b=a,c=document.createElement("a");return L&&(c.setAttribute("href",b),b=c.href),c.setAttribute("href",b),{href:c.href,protocol:c.protocol?c.protocol.replace(/:$/,""):"",host:c.host,search:c.search?c.search.replace(/^\?/,""):"",hash:c.hash?c.hash.replace(/^#/,""):"",hostname:c.hostname,port:c.port,pathname:"/"===c.pathname.charAt(0)?c.pathname:"/"+c.pathname}}var L,M,N,O=a.bMoor||{},P=a.bmoor||{},Q={};L=parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1],10),isNaN(L)&&(L=parseInt((/trident\/.*; rv:(\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1],10)),B(O,{parseNS:c,dwrap:m,set:d,get:e,exists:f,register:g,check:h,find:i,install:j,ensure:F,request:G,translate:H,inject:I,plugin:J,makeQuark:E,create:A,extend:B,copy:C,equals:D,loop:w,each:x,iterate:y,forEach:z,isDefined:o,isUndefined:n,isArray:u,isArrayLike:t,isObject:s,isFunction:r,isNumber:q,isString:p,trim:v,error:k,urlResolve:K}),d("bMoor",O),d("bmoor",P),M=F("bmoor.defer.Basic",!0),N=F("bmoor.defer.Group",!0),M.prototype.resolve=function(a){w(this.promise.waiting,function(b){b(a)}),this.promise.waiting=a},M.prototype.promise={waiting:[],then:function(a){return this.waiting.push?this.waiting.push(a):a(this.waiting),M.prototype.promise}}}(this),function(a){var b,c=a.ensure("bmoor.defer.Basic"),d=a.ensure("bmoor.build.Compiler");d.prototype._construct=function(){this.stack=[],this.clean=!0},d.prototype.addModule=function(b,c,d){this.clean=!1,arguments.length<3?d=c:a.install(c,d[d.length-1]),this.stack.push({rank:parseInt(b,10),module:d})},d.prototype.make=function(b){var d,e=new c,f=e.promise;if(a.isString(b.name))b.id=b.name,b.namespace=a.parseNS(b.name);else{if(!a.isArray(b.name))throw"you need to define a name and needs to be either a string or an array";b.namespace=b.name,b.id=b.name.join(".")}return d=a.ensure(b.id),b.name=b.namespace.pop(),b.mount=a.get(b.namespace),this.clean||(this.stack.sort(function(a,b){return b.rank-a.rank}),this.clean=!0),e.resolve(d),a.loop(this.stack,function(c){f=f.then(function(){a.inject(c.module,b,d)})}),f.then(function(){d.prototype.__postMake&&d.prototype.__postMake(d),d.$defer&&(d.$loaded=!0,d.$defer.resolve(d))}),d},b=new d,d.$instance=b,d.$defer.resolve(d),a.install("bmoor.build.Compiler",d),a.install("bmoor.build.$compiler",b),a.plugin("define",function(a){return b.make(a)})}(bMoor),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(20,"bmoor.build.ModConstruct",["construct","id",function(a){a&&(this.prototype._construct=a)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(9,"bmoor.build.ModDecorate",["decorators",function(a){var b=this.prototype;if(a){if(!bMoor.isArray(a))throw"the decoration list must be an array";return bMoor.request(a).then(function(a){bMoor.loop(a,function(a){a.$singleton&&a.$singleton.$decorate(b)})})}}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(5,"bmoor.build.ModFactory",["factory",function(a){var b=this;a&&(b.$make=function(){var a=arguments;return a.$arguments=!0,new b(a)})}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(1,"bmoor.build.ModFinalize",["namespace","name","mount","postMake",function(a,b,c,d){var e,f=this,g=f.prototype;g.__namespace=a,g.__name=b,g.__mount=c,d&&(g.__postMake?(e=g.__postMake,g.__postMake=function(){e(f),d&&d(f)}):g.__postMake=d)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(90,"bmoor.build.ModInherit",["parent",function(a){var b;a&&(Parent=bMoor.ensure(a),b=Parent.prototype.__class,void 0!==Parent.$construct?(Parent.$construct=!1,this.prototype=new Parent,Parent.$construct=!0):this.prototype=new Parent,this.prototype.constructor=this,this.prototype[b]=Parent.prototype)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(4,"bmoor.build.ModPlugin",["plugins",function(a){var b=this.$instance||this;bMoor.iterate(a,function(a,c){bMoor.isString(a)&&(a=b[a]),bMoor.plugin(c,function(){return a.apply(b,arguments)})})}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){function b(a,b){var c;for(c in b)a.prototype[c]=b[c]}a.$instance.addModule(10,"bmoor.build.ModPropertoes",["properties",function(a){var c=this;return bMoor.isArray(a)?bMoor.inject(a,!0).then(function(a){b(c,a)}):(b(this,a),void 0)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(0,"bmoor.build.ModRegister",["id",function(a){bMoor.register(a,this)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(100,"bmoor.build.ModRequire",["require",function(a){var b,c,d=new bmoor.defer.Group;return a&&(bMoor.isString(a)?b=[a]:bMoor.isArrayLike(a)?b=a:(b=a.classes,c=a.aliases),bMoor.loop(b,function(a){d.add(bmoor.comm.$require.one(a))}),bMoor.iterate(c,function(a,b){d.add(bmoor.comm.$require.one(a,!0,b))})),d.promise}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(5,"bmoor.build.ModSingleton",["singleton","name","mount",function(a,b,c){var d=this;a&&(bMoor.isArray(a)||(a=[]),a.$arguments=!0,d.$instance=c["$"+b.toLowerCase()]=new d(a))}])})}(),function(){bMoor.define({name:"bmoor.defer.Promise",construct:function(a){this.defer=a},properties:{then:function(a,b){var c,d,e=this.defer,f=this.defer.sub();return c=function(b){try{f.resolve((a||e.defaultSuccess)(b))}catch(c){f.reject(c),e.handler(c)}},d=function(a){try{f.resolve((b||e.defaultFailure)(a))}catch(c){f.reject(c),e.handler(c)}},e.register(c,d),f.promise},done:function(a){return this.then(a),this},fail:function(a){return this.then(null,a),this},always:function(a){return this["finally"](a),this},"catch":function(a){return this.then(null,a)},"finally":function(a){function b(a,b){var c=bmoor.defer.Basic();return b?c.resolve(a):c.reject(a),c.promise}function c(c,d){var e=null;try{e=(a||dis.defaultSuccess)()}catch(f){return b(f,!1)}return e&&bMoor.isFunction(e.then)?e.then(function(){return b(c,d)},function(a){return b(a,!1)}):b(c,d)}return this.then(function(a){return c(a,!0)},function(a){return c(a,!1)})}}})}(),function(a){function b(b){return b&&b.then?b:{then:function(c){bMoor.isArrayLike(b)&&b.$inject?c.apply(a,b):c(b)}}}function c(a){return{then:function(b,c){c(a)}}}bMoor.define({name:"bmoor.defer.Basic",construct:function(a){this.handler=a||this.defaultHandler,this.callbacks=[],this.value=null,this.promise=new bmoor.defer.Promise(this)},properties:{defaultHandler:function(a){bMoor.error(a)},defaultSuccess:function(a){return a},defaultFailure:function(){return a},register:function(a,b){this.value?this.value.then(a,b):this.callbacks.push([a,b])},resolve:function(a){var c,d,e,f;if(this.callbacks)for(c=this.callbacks,this.callbacks=null,this.value=b(a),e=0,f=c.length;f>e;e++)d=c[e],this.value.then(d[0],d[1])},reject:function(a){this.resolve(c(a))},sub:function(){return new bmoor.defer.Basic(this.handler)}}})}(),function(){function a(){0===this.count&&this.loaded&&(this.errors.length?this.defer.reject(errors):this.defer.resolve(!0))}function b(){this.count--,a.call(this)}bMoor.define({name:"bmoor.defer.Group",construct:function(){this.count=0,this.loaded=!1,this.errors=[],this.defer=new bmoor.defer.Basic,this.promise=this.defer.promise},properties:{add:function(a){var c=this;this.count++,a.then(function(){b.call(c)},function(a){c.errors.push(a),b.call(c)})},run:function(){this.loaded=!0,a.call(this)}},plugins:{allDone:function(){var a,b=this,c=new b;return a=arguments.length>1?arguments:arguments[0],bMoor.isArrayLike(a)?bMoor.loop(a,function(a){c.add(a)}):bMoor.iterate(a,function(a){c.add(a)}),c.run(),c.promise}}})}(),function(){function a(a,b){return this.promise.then(function(){return a.apply({},b||[])})}bMoor.define({name:"bmoor.defer.Group",construct:function(){this.promise=null},properties:{getPromise:function(){return this.promise},isStacked:function(){return null!==this.promise},begin:function(){this.promise=null},run:function(a){this.promise?this.promise["finally"](a):a()},add:function(b,c){return this.promise?this.promise=a.call(this,[b,c]):(this.promise=b.apply({},c),this.promise.then||(this.promise=null)),this.promise}}})}(),function(){bMoor.define({name:"bmoor.comm.Connector",properties:{request:function(a,b){var c=new bmoor.comm[a](b);return c.$defer.promise},http:function(a){return this.request("Http",a)},get:function(a,b){return bMoor.isString(a)&&(a={url:a}),b&&(a.data=b),a.method="GET",this.http(a)},post:function(a,b){return bMoor.isString(a)&&(a={url:a}),b&&(a.data=b),a.method="POST",this.http(a)},script:function(a){return bMoor.isObject(a)&&(a=a.url||a.src),this.request("Script",a)},style:function(a){return bMoor.isObject(a)&&(a=a.url||a.src),this.request("Style",a)},image:function(a){var b=new bmoor.defer.Basic,c=new Image;return"#"==a[0]&&(a=$(a)[0].src),c.onload=function(){b.resolve(!0)},c.src=a,b.promise}}})}(),function(){var a=window.XMLHttpRequest||function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(b){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(c){}throw"error"};bMoor.define({name:"bmoor.comm.Http",construct:function(a){var b=this,c=this.makeXHR(a.method.toUpperCase(),a.url,void 0===a.async?!0:a.async,a.user,a.password);c.onreadystatechange=function(){4==c.readyState&&(-2!==b.status&&(b.status=c.status),b.resolve(c.responseType?c.response:c.responseText,c.getAllResponseHeaders()))},bMoor.forEach(a.headers,function(a,b){c.setRequestHeader(b,a)}),a.mimeType&&c.overrideMimeType(a.mimeType),a.responseType&&(c.responseType=a.responseType),this.url=bMoor.urlResolve(a.url),this.status=null,this.connection=c,this.$defer=new bmoor.defer.Basic,c.send(a.data||null)},properties:{makeXHR:function(b,c,d,e,f){var g=new a;return"withCredentials"in g||(g="undefined"!=typeof XDomainRequest?new XDomainRequest:null),g.open(b,c,d,e,f),g},abort:function(){null===this.status&&(this.status=-2,this.connection&&this.connection.abort())},resolve:function(a,b){var c,d=this.status,e=this.url.protocol;this.connection=null,d="file"==e&&0===d?a?200:404:d,d=1223==d?204:d,c=d>=200&&300>d?"resolve":"reject",this.$defer[c]({data:a,status:d,headers:b})}}})}(),function(a,b){"use strict";a.define({name:"bmoor.comm.Registry",singleton:!0,construct:function(){var b,c,d;a.root||(b=document.getElementsByTagName("script"),c=b[b.length-1],c.hasAttribute("root")?a.root=c.getAttribute("root"):(d=c.getAttribute("src").match(/^(.*)\/b[Mm]oor(\.min)?\.js/),d?a.root=d[1]:(d=c.getAttribute("src").match(/^(.*)\/(js|src|scripts)/),a.root=d?d[0]:""))),this.reset(a.root)},plugins:{"ns.locate":function(a){return this.locate(a)},"ns.register":function(a,b,c,d){return this.set(a,b,c,d)}},properties:{libRoots:{},parseResource:function(a){var b=a.match(/^(.*)\/(js|src)/);return b?b[1]:null},reset:function(a){this.libRoots={},this.setRoot(a)},setRoot:function(a){this.libRoots["."]={fullName:!1},this.libRoots["/"]=a,this.libRoots[">"]=this.parseResource(a),this.libRoots.jquery={"/":a+"/jquery",".":{fullName:!0}}},set:function(c,d,e,f){var g=this.libRoots,h=a.parseNS(c);for(e||(e={});h.length;){var i=h.shift();g[i]===b&&(g[i]={}),g=g[i]}g["/"]=d,g["."]=e,g["*"]=f===!0,g[">"]=this.parseResource(d)},del:function(b){for(var c=this.libRoots,d=null,e=null,f=a.parseNS(b);f.length&&c;){var g=f.shift();c[g]?(d=c,e=g,c=c[e]):c=null}c&&delete d[e]},get:function(b,c){for(var d=this.libRoots,e=this.libRoots,f=a.parseNS(b),g=c?null:f.pop(),h=f.slice(0);f.length;){var i=f[0];if(!d[i])break;d=d[f.shift()],d["/"]&&(e=d,h=f.slice(0))}return{root:e["/"],path:e["*"]?[]:h,name:g,settings:e["."],resource:e[">"]}},locate:function(a){var b=this.get(a);return b.root+(b.path.length?"/"+b.path.join("/"):"")+"/"+(b.settings.fullName?a:b.name)}}})}(bMoor),function(){bMoor.define({name:"bmoor.comm.Require",singleton:!0,properties:{forceSync:!1,one:function(a,b,c){var d;return d=bMoor.exists(a),d?b===!1?d:d.$defer?d.$defer.promise:bMoor.dwrap(d):(d=new bmoor.comm.Script(bMoor.ns.locate(c||a)+".js",this.forceSync?!1:b),b===!1?bMoor.exists(a):d.$defer.promise.then(function(){var b=bMoor.exists(a);return b.$defer?b.$defer.promise:b}))},hash:function(a){var b,c=bmoor.defer.Group();for(b in a)c.add(this.one(b,!0,a[b]));c.run()},list:function(a){var b,c,d=bmoor.defer.Group();for(b=0,c=a.length;c>b;b++)d.add(this.one(a[b]))}},plugins:{require:function(a,b){var c;return this.forceSync=!0,c=this.one(a,!1,b),this.forceSync=!1,c}}})}(),function(){"use strict";bMoor.define({name:"bmoor.comm.Resource",construct:function(a,b){var c=this;this.$defer=new bmoor.defer.Basic,new bmoor.comm.Http({method:"GET",url:a,async:b}).$defer.promise.then(function(a){c.apply(a.data),c.success()},function(){c.failure()})},properties:{apply:function(){},success:function(){this.status=200,this.resolve()},failure:function(){this.status=404,this.resolve()},resolve:function(){200===this.status?this.$defer.resolve():this.$defer.reject()}}})}(),function(){bMoor.define({name:"bmoor.comm.Script",parent:"bmoor.comm.Resource",properties:{apply:function(a){var b=document.createElement("script");b.text=a,document.body.appendChild(b)}}})}(),function(){bMoor.define({name:"bmoor.comm.Style",parent:"bmoor.comm.Resource",properties:{apply:function(a){var b=document.createElement("style");b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a)),document.body.appendChild(b)}}})}(),function(a){function b(a,b,c){var d=typeof c,e=b[a];"function"==d?b[a]=function(){var a,b=this._wrapped;return this.$wrapped=e,a=c.apply(this,arguments),this.$wrapped=b,a}:"string"==d&&(b[a]+=" "+c)}a.define({name:"bmoor.core.Decorator",postMake:function(a){a.$singleton=new a},properties:{$decorate:function(a){var c;for(c in this)"_construct"!==c&&"$decorate"!==c&&("__construct"===c?b("_construct",a,this[c]):a[c]?b(c,a,this[c]):a[c]=this[c])}}})}(this.bMoor),function(){bMoor.define({name:"bmoor.core.Interval",singleton:!0,construct:function(){this._c=0,this.timeouts={},this.hash={}},properties:{set:function(a,b){var c,d=this.timeouts[b],e=this._c++;return d||(d=this.timeouts[b]={_c:0},d._hk=setInterval(function(){bmoor.iterate(d,function(a){a()})},b)),c=d._c++,d[c]=a,this.hash[e]={hk:d._c,val:b},e},clear:function(a){var b=this.hash[a];b&&(delete this.timeouts[b.val][b.hk],delete this.hash[a])}},plugins:{setInterval:"set",clearInterval:"clear"}})}(),function(a,b){function c(a,e){var f,g,h;for(f in a)a.hasOwnProperty(f)&&(g=a[f],h=e[f],h===b?e[f]=g:angular.isArray(g)?(angular.isArray(h)||(h=e[f]=[]),d(g,h)):angular.isObject(g)?(angular.isObject(h)||(h=e[f]={}),c(g,h)):g!=h&&(e[f]=g));for(f in e)e.hasOwnProperty(f)&&a[f]===b&&delete e[f];return e}function d(a,e){var f,g,h,i;for(f=0,g=a.length;g>f;f++)h=a[f],i=e[f],i===b?e[f]=h:angular.isObject(h)?(angular.isObject(i)||(i=e[f]={}),c(h,i)):angular.isArray(h)?(anguar.isArray(i)||(i=e[f]=[]),d(h,i)):h!==i&&(e[f]=h);for(f=g,g=e.length;g>f;f++)e.pop()}bMoor.define({name:"bmoor.model.Basic",construct:function(a){var b;for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this._inflate()},properties:{_validate:function(){return null},_inflate:function(){},_deflate:function(){},_update:function(a){c(a,this),this._inflate()},_toObject:function(){var a,b={};this._deflate();for(a in this)this.hasOwnProperty(a)&&"_"!==a.charAt(0)&&(b[a]=this[a]);return b},_toJson:function(){return JSON.stringify(this._toObject())}}})}(this);