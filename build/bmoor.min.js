/*! bmoor 2014-03-20 */
!function(a,b){"use strict";function c(a){return a?r(a)?a.split("."):x(a)?a.slice(0):a:[]}function d(b,d,e){var f,g=e||a;if(b&&(r(b)||w(b))){b=c(b);for(var h=0;h<b.length;h++)f=b[h],h===b.length-1?g[f]=d:(g[f]||(g[f]={}),g=g[f])}}function e(b,d){var e,f=d||a;if(b&&(r(b)||w(b))){b=c(b);for(var g=0;g<b.length;g++)e=b[g],f[e]||(f[e]={}),f=f[e];return f}return u(b)?b:null}function f(a,b){if(r(a)||w(a)){a=c(a);for(var d=0;d<a.length;d++){var e=a[d];if(!b[e])return null;b=b[e]}return b}return u(a)?a:null}function g(b,c){var d,e,g;if(c){if(w(c)){for(d=0,e=c.length;e>d&&!g;d++)g=f(b,c[d]);return g}return f(b,c)}return f(b,a)}function h(a,b){Z[a]=b}function i(a){return Z[a]}function j(a,c){var d;return c===b&&(d=i(x(a)?a.join("."):a))?d:g(a,c)}function k(a,b){d(a,b),h(a,b)}function l(a){u(a)?(console.log(a),console.log(a.stack)):(console.log(a),console.trace())}function m(a){return Object.prototype.toString.call(a)}function n(a){var b;return a.$?b=a.$.promise:(b=new V,b.resolve(a)),b.promise}function o(a){var b;if(u(a)){for(b in a)if(a.hasOwnProperty(b))return!1}else if(w(a))return 0===a.length;return!0}function p(a){return a===b}function q(a){return a!==b}function r(a){return"string"==typeof a}function s(a){return"number"==typeof a}function t(a){return"function"==typeof a}function u(a){return a&&"object"==typeof a}function v(a){return"boolean"==typeof a}function w(a){return a&&"number"==typeof a.length&&a.push}function x(a){return a&&"[object Array]"===m(a)}function y(a,b,c){var d,e;for(c||(c=a),d=0,e=a.length;e>d;++d)d in a&&b.call(c,a[d],d,a)}function z(a,b,c){var d;c||(c=a);for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)}function A(a,b,c){var d;c||(c=a);for(d in a)a.hasOwnProperty(d)&&"_"!==d.charAt(0)&&"prototype"!==d&&"length"!==d&&"name"!==d&&b.call(c,a[d],d,a)}function B(a,b,c){a&&(a.forEach&&a.forEach!==B?a.forEach(b,c):w(a)?y(a,b,c):t(a)?A(a,b,c):z(a,b,c))}function C(a){if(Object.create)return Object.create(a);var b=function(){};if(1!==arguments.length)throw new Error("create implementation only accepts one parameter.");return b.prototype=a,new b}function D(a){return y(arguments,function(b){b!==a&&z(b,function(b,c){a[c]=b})}),a}function E(a,b,c){if(a===b)return b;if(b)if(b.copy)b.copy(a);else if(w(a)){b.length=0;for(var d=0,e=a.length;e>d;d++)b.push(E(a[d]))}else z(b,function(a,c){delete b[c]}),z(a,function(a,c){b[c]=a});else b=a,a&&(b=a.clone?a.clone():w(a)?E(a,[],c):E(a,{},c));return b}function F(a,c){var d,e,f,g=typeof a,h=typeof c;if(a===c)return!0;if(a!==a&&c!==c)return!0;if(null===a||a===b||null===c||null===c)return!1;if(a.equals)return a.equals(c);if(c.equals)return c.equals(a);if(g===h&&"object"===g)if(w(a)){if(!w(c))return!1;if((d=a.length)===c.length){for(e=0;d>e;e++)if(!F(a[e],c[e]))return!1;return!0}}else if(!w(c)){f={};for(e in a)if(a.hasOwnProperty(e)){if(!F(a[e],c[e]))return!1;f[e]=!0}for(e in c)if(c.hasOwnProperty(e)&&!f&&c[e]!==b)return!1}return!1}function G(b){function c(b){if(this===a)throw"You forgot to new...";this.$={},b&&b.$arguments?this._construct.apply(this,b):this._construct.apply(this,arguments)}return c.$={},V&&(c.$.defer=new V,c.$.promise=c.$.defer.promise),c.prototype.__class=b,c.prototype._construct=function(){},d(b,c),c}function H(a,b){var c=g(a,b);return a||console.trace(),c?c:G(a)}function I(a,b){var c=[];return y(a,function(a,d){if(r(a))switch(a.charAt(0)){case"@":c[d]=i(a.substr(1));break;case"-":c[d]=g(a.substr(1),b);break;case"+":a=a.substr(1);default:c[d]=H(a,b)}else c[d]=a}),c}function J(a,b){var c;return console.log(a),r(a)?(c=H(a,b),c.$?c.$.promise:n(c)):w(a)?(c=new W,y(a,function(d,e){r(d)&&(d=H(d,b),a[e]=d),d&&d.$&&c.add(d.$.promise)}),c.run(),c.promise.then(function(){return a})):void 0}function K(a){return t(a)||x(a)&&t(a[a.length-1])}function L(a,b,c,d){var e,f;if(d=arguments[arguments.length-1],v(d)||(d=!1),t(a))e=a,a=[];else{if(!x(a))throw"inject needs arr to be either Array or Function";e=a[a.length-1]}return f=I(a,b),d?J(f).then(function(){return e.apply(c,f)}):e.apply(c,f)}function M(a,b){d(a,b,X)}function N(a){var b=a,c=document.createElement("a");return U&&(c.setAttribute("href",b),b=c.href),c.setAttribute("href",b),{href:c.href,protocol:c.protocol?c.protocol.replace(/:$/,""):"",host:c.host,search:c.search?c.search.replace(/^\?/,""):"",hash:c.hash?c.hash.replace(/^#/,""):"",hostname:c.hostname,port:c.port,pathname:"/"===c.pathname.charAt(0)?c.pathname:"/"+c.pathname}}function O(a){a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function P(a,b,c){if(a.indexOf)return a.indexOf(b,c);var d=a.length>>>0;for(c=+c||0,1/0===Math.abs(c)&&(c=0),0>c&&(c+=d,0>c&&(c=0));d>c;c++)if(a[c]===b)return c;return-1}function Q(a,b,c){var d=P(a,b,c);d>-1&&a.splice(d,1)}function R(a,b,c){var d=P(a,b,c);d>-1&&(a.splice(d,1),R(a,b,d))}function S(a,b,c){if(a.filter)return a.filter(b,c);var d,e,f=Object(this),g=f.length>>>0,h=[];if("function"!=typeof b)throw"func needs to be a function";for(d=0;g>d;d++)d in f&&(e=f[d],b.call(c,e,d,f)&&h.push(e));return h}function T(a,b,c){var d,e=[],f=[],g=[],h=[];for(a=a.slice(0),b=b.slice(0),a.sort(c),b.sort(c);a.length>0&&b.length>0;)d=c(a[0],b[0]),0>d?e.push(a.shift()):d>0?f.push(b.shift()):(g.push(a.shift()),h.push(b.shift()));for(;a.length;)e.push(a.shift());for(;b.length;)f.push(b.shift());return{left:e,intersection:{left:g,right:h},right:f}}var U,V,W,X=a.bMoor||{},Y=a.bmoor||{},Z={};U=parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1],10),isNaN(U)&&(U=parseInt((/trident\/.*; rv:(\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1],10)),D(X,{parseNS:c,dwrap:n,set:d,get:e,exists:g,register:h,check:i,find:j,install:k,ensure:H,request:J,translate:I,inject:L,plugin:M,makeQuark:G,loop:y,each:z,iterate:A,forEach:B,isBoolean:v,isDefined:q,isUndefined:p,isArray:x,isArrayLike:w,isObject:u,isFunction:t,isNumber:s,isString:r,isInjectable:K,isEmpty:o,object:{create:C,extend:D,copy:E,equals:F},string:{trim:O},array:{compare:T,indexOf:P,remove:Q,removeAll:R,filter:S},error:{report:l},url:{resolve:N}}),h("global",a),h("undefined",b),d("bMoor",X),d("bmoor",Y),L(["bmoor.defer.Basic","bmoor.defer.Group",function(a,b){var c=0;V=a,W=b,V.prototype._construct=function(){this.promise={count:c++,then:function(a){return this.waiting&&this.waiting.push?this.waiting.push(a):a(this.waiting),this},waiting:[]}},V.prototype.resolve=function(a){y(this.promise.waiting,function(b){b(a)}),this.promise.waiting=a},W.prototype.run=function(){}}])}(this),bMoor.inject(["bmoor.defer.Basic","bmoor.build.Compiler","@global",function(a,b){function c(b,c,d){var e=new a,f=e.promise,g=b.$.defer;if(b.$.defer=null,bMoor.isString(c))d.id=c,d.namespace=bMoor.parseNS(c);else{if(!bMoor.isArray(c))throw JSON.stringify(c)+" > "+JSON.stringify(d)+" > message : you need to define a name and needs to be either a string or an array";d.namespace=c,d.id=c.join(".")}d.name=d.namespace.pop(),d.mount=bMoor.get(d.namespace),this.clean||(this.stack.sort(function(a,b){return b.rank-a.rank}),this.clean=!0),e.resolve(),bMoor.loop(this.stack,function(a){f=f.then(function(){return bMoor.inject(a.module,d,b)})}),f.then(function(){b.$onMake&&b.$onMake(d),g&&g.resolve(b)})}var d,e=b.$.defer;b.prototype._construct=function(){this.stack=[],this.clean=!0},b.prototype.addModule=function(a,b,c){this.clean=!1,arguments.length<3?c=b:bMoor.install(b,c[c.length-1]),this.stack.push({rank:parseInt(a,10),module:c})},b.prototype.make=function(a,b){var d=this,e=bMoor.ensure(a);if(2!==arguments.length)throw"you need to define a name and a definition";return bMoor.isInjectable(b)?bMoor.require?bMoor.require.inject(b).then(function(b){c.call(d,e,a,b)}):bMoor.inject(b,!0).then(function(b){c.call(d,e,a,b)}):c.call(this,e,a,b),e.$.promise},d=new b,b.$instance=d,bMoor.install("bmoor.build.$compiler",d),bMoor.plugin("define",function(a,b){return d.make(a,b)}),b.$.defer=null,e.resolve(b)}]),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(20,"bmoor.build.ModConstruct",["-construct","-abstract","-id",function(a,b,c){b?this.prototype._construct=function(){throw c+" is abstracted, either extend or use only static members"}:a&&(this.prototype._construct=a)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(9,"bmoor.build.ModDecorate",["-decorators",function(a){var b=this.prototype;if(a){if(!bMoor.isArray(a))throw"the decoration list must be an array";return bMoor.request(a).then(function(a){bMoor.loop(a,function(a){a.$wrap&&a.$wrap(b)})})}}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(5,"bmoor.build.ModFactory",["-factory",function(a){var b=this;a&&(b.$make=function(){var a=arguments;return a.$arguments=!0,new b(a)})}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(1,"bmoor.build.ModFinalize",["-onMake","-parent",function(a,b){{var c=this;c.prototype}return b?bMoor.request(b).then(function(b){a?(c.$onMake=a,c.$parentMakes=b.$parentMakes?bMoor.create(b.$parentMakes):{},c.$parentMakes[b.prototype.__class]=b.$onMake):c.$onMake=b.$onMake}):(a&&(c.$onMake=a),void 0)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(90,"bmoor.build.ModInherit",["-id","-namespace","-name","-mount","-parent",function(a,b,c,d,e){var f,g,h=this;return e?bMoor.inject([e,function(e){g=e.prototype.__class,f=function(){this.constructor=h},f.prototype=e.prototype,h.prototype=new f,h.prototype[g]=e.prototype,h.prototype.__class=a,h.prototype.__namespace=b,h.prototype.__name=c,h.prototype.__mount=d}]):(this.prototype.__class=a,this.prototype.__namespace=b,this.prototype.__name=c,this.prototype.__mount=d,void 0)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(4,"bmoor.build.ModPlugin",["-plugins",function(a){var b=this.$instance||this;bMoor.iterate(a,function(a,c){bMoor.isString(a)&&(a=b[a]),bMoor.plugin(c,function(){return a.apply(b,arguments)})})}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(10,"bmoor.build.ModProperties",["-properties",function(a){var b;bMoor.isInjectable(a)&&(a=bMoor.inject(a));for(b in a)this.prototype[b]=a[b]}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(0,"bmoor.build.ModRegister",["-id",function(a){bMoor.register(a,this)}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(100,"bmoor.build.ModRequire",["-require",function(a){var b,c,d=new bmoor.defer.Group;return a&&(bMoor.isString(a)?b=[a]:bMoor.isArrayLike(a)?b=a:(b=a.classes||[],c=a.aliases||{}),bMoor.loop(b,function(a){d.add(bmoor.comm.$require.get(a))}),bMoor.iterate(c,function(a,b){d.add(bmoor.comm.$require.get(b,!0,a))})),d.run&&d.run(),d.promise}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(5,"bmoor.build.ModSingleton",["-singleton","-name","-mount",function(a,b,c){var d=this;a&&(bMoor.isArray(a)||(a=[]),a.$arguments=!0,d.$instance=c["$"+b[0].toLowerCase()+b.substr(1)]=new d(a))}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(10,"bmoor.build.ModStatics",["-statics",function(a){var b;bMoor.isInjectable(a)&&(a=bMoor.inject(a));for(b in a)this.prototype[b]=a[b]}])})}(),function(){bMoor.request("bmoor.build.Compiler").then(function(a){a.$instance.addModule(8,"bmoor.build.ModTraits",["-traits",function(a){var b=this.prototype;if(a){if(!bMoor.isArray(a))throw"the traits list must be an array";return bMoor.request(a).then(function(a){bMoor.loop(a,function(a){a.$wrap&&a.$wrap(b)})})}}])})}(),function(){bMoor.define("bmoor.defer.Promise",{construct:function(a){this.defer=a},properties:{then:function(a,b){var c,d,e=this.defer,f=this.sub=this.defer.sub();return c=function(b){try{f.resolve((a||e.defaultSuccess)(b)),this.sub=null}catch(c){this.sub=null,f.reject(c),e.handler(c)}},d=function(a){try{f.resolve((b||e.defaultFailure)(a)),this.sub=null}catch(c){this.sub=null,f.reject(c),e.handler(c)}},e.register(c,d),f.promise},reject:function(a){if(!this.sub)throw"must reject from inside a then";this.sub.reject(a)},done:function(a){return this.then(a),this},fail:function(a){return this.then(null,a),this},always:function(a){return this["finally"](a),this},"catch":function(a){return this.then(null,a)},"finally":function(a){function b(a,b){var c=bmoor.defer.Basic();return b?c.resolve(a):c.reject(a),c.promise}function c(c,d){var e=null;try{e=(a||dis.defaultSuccess)()}catch(f){return b(f,!1)}return e&&bMoor.isFunction(e.then)?e.then(function(){return b(c,d)},function(a){return b(a,!1)}):b(c,d)}return this.then(function(a){return c(a,!0)},function(a){return c(a,!1)})}}})}(),function(a){function b(b){return b&&b.then?b:{then:function(c){bMoor.isArrayLike(b)&&b.$inject?c.apply(a,b):c(b)}}}function c(a){return{then:function(b,c){c(a)}}}bMoor.define("bmoor.defer.Basic",{construct:function(a){this.handler=a||this.defaultHandler,this.callbacks=[],this.value=null,this.promise=new bmoor.defer.Promise(this)},properties:{defaultHandler:function(a){bMoor.error.report(a)},defaultSuccess:function(a){return a},defaultFailure:function(a){throw a},register:function(a,b){this.value?this.value.then(a,b):this.callbacks.push([a,b])},resolve:function(a){var c,d,e,f;if(this.callbacks)for(c=this.callbacks,this.callbacks=null,this.value=b(a),e=0,f=c.length;f>e;e++)d=c[e],this.value.then(d[0],d[1])},reject:function(a){this.resolve(c(a))},sub:function(){return new bmoor.defer.Basic(this.handler)}}})}(),function(){function a(){0===this.count&&this.loaded&&(this.errors.length?this.defer.reject(errors):this.defer.resolve(!0))}function b(){this.count--,a.call(this)}bMoor.define("bmoor.defer.Group",{construct:function(){this.count=0,this.loaded=!1,this.errors=[],this.defer=new bmoor.defer.Basic,this.promise=this.defer.promise},properties:{add:function(a){var c=this;this.count++,a.then(function(){b.call(c)},function(a){c.errors.push(a),b.call(c)})},run:function(){this.loaded=!0,a.call(this)}},plugins:{allDone:function(){var a,b=this,c=new b;return a=arguments.length>1?arguments:arguments[0],bMoor.isArrayLike(a)?bMoor.loop(a,function(a){c.add(a)}):bMoor.iterate(a,function(a){c.add(a)}),c.run(),c.promise}}})}(),function(){function a(a,b){return this.promise.then(function(){return a.apply({},b||[])})}bMoor.define("bmoor.defer.Stack",{construct:function(){this.promise=null},properties:{getPromise:function(){return this.promise},isStacked:function(){return null!==this.promise},begin:function(){this.promise=null},run:function(a){this.promise?this.promise["finally"](a):a()},add:function(b,c){return this.promise?this.promise=a.call(this,[b,c]):(this.promise=b.apply({},c),this.promise.then||(this.promise=null)),this.promise}}})}(),function(){bMoor.define("bmoor.comm.Connector",{properties:{request:function(a,b){var c=new bmoor.comm[a](b);return c.$.promise},http:function(a){return this.request("Http",a)},get:function(a,b){return bMoor.isString(a)&&(a={url:a}),b&&(a.data=b),a.method="GET",this.http(a)},post:function(a,b){return bMoor.isString(a)&&(a={url:a}),b&&(a.data=b),a.method="POST",this.http(a)},script:function(a){return bMoor.isObject(a)&&(a=a.url||a.src),this.request("Script",a)},style:function(a){return bMoor.isObject(a)&&(a=a.url||a.src),this.request("Style",a)},image:function(a){var b=new bmoor.defer.Basic,c=new Image;return"#"==a[0]&&(a=$(a)[0].src),c.onload=function(){b.resolve({data:c,valid:!0,status:200,headers:void 0})},c.src=a,b.promise}}})}(),function(){var a=window.XMLHttpRequest||function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(b){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(c){}throw"error"};bMoor.define("bmoor.comm.Http",{construct:function(a){var b=this,c=this.makeXHR(a.method.toUpperCase(),a.url,void 0===a.async?!0:a.async,a.user,a.password);c.onreadystatechange=function(){4==c.readyState&&(-2!==b.status&&(b.status=c.status),b.resolve(c.responseType?c.response:c.responseText,c.getAllResponseHeaders()))},bMoor.forEach(a.headers,function(a,b){c.setRequestHeader(b,a)}),a.mimeType&&c.overrideMimeType(a.mimeType),a.responseType&&(c.responseType=a.responseType),this.url=bMoor.url.resolve(a.url),this.status=null,this.connection=c,this.$.defer=new bmoor.defer.Basic,this.$.promise=this.$.defer.promise,c.send(a.data||null)},properties:{makeXHR:function(b,c,d,e,f){var g=new a;return"withCredentials"in g||(g="undefined"!=typeof XDomainRequest?new XDomainRequest:null),g.open(b,c,d,e,f),g},abort:function(){null===this.status&&(this.status=-2,this.connection&&this.connection.abort())},resolve:function(a,b){var c,d,e=this.status,f=e>=200&&300>e,g=this.url.protocol;this.connection=null,e="file"==g&&0===e?a?200:404:e,e=1223==e?204:e,d=f?"resolve":"reject",c=[a,e,b],c.$inject=!0,this.$.defer[d](c)}},plugins:{$http:function(a){var b;return b=new b(a),b.$.promise}}})}(),function(a,b){"use strict";a.define("bmoor.comm.Registry",{singleton:!0,construct:function(){var b,c,d;a.root||(b=document.getElementsByTagName("script"),c=b[b.length-1],c.hasAttribute("root")?a.root=c.getAttribute("root"):(d=c.getAttribute("src").match(/^(.*)\/b[Mm]oor(\.min)?\.js/),d?a.root=d[1]:(d=c.getAttribute("src").match(/^(.*)\/(js|src|scripts)/),a.root=d?d[0]:""))),this.reset(a.root)},plugins:{"ns.locate":function(a){return this.locate(a)},"ns.register":function(a,b,c,d){return this.set(a,b,c,d)}},properties:{libRoots:{},parseResource:function(a){var b=a.match(/^(.*)\/(js|src)/);return b?b[1]:null},reset:function(a){this.libRoots={},this.setRoot(a)},setRoot:function(a){this.libRoots["."]={fullName:!1},this.libRoots["/"]=a,this.libRoots[">"]=this.parseResource(a),this.libRoots.jquery={"/":a+"/jquery",".":{fullName:!0}}},set:function(c,d,e,f){var g=this.libRoots,h=a.parseNS(c);for(e||(e={});h.length;){var i=h.shift();g[i]===b&&(g[i]={}),g=g[i]}g["/"]=d,g["."]=e,g["*"]=f===!0,g[">"]=this.parseResource(d)},del:function(b){for(var c=this.libRoots,d=null,e=null,f=a.parseNS(b);f.length&&c;){var g=f.shift();c[g]?(d=c,e=g,c=c[e]):c=null}c&&delete d[e]},get:function(b,c){for(var d=this.libRoots,e=this.libRoots,f=a.parseNS(b),g=c?null:f.pop(),h=f.slice(0);f.length;){var i=f[0];if(!d[i])break;d=d[f.shift()],d["/"]&&(e=d,h=f.slice(0))}return{root:e["/"],path:e["*"]?[]:h,name:g,settings:e["."],resource:e[">"]}},locate:function(a){var b=this.get(a);return b.root+(b.path.length?"/"+b.path.join("/"):"")+"/"+(b.settings.fullName?a:b.name)}}})}(bMoor),bMoor.define("bmoor.comm.Require",function(){function a(a){var b,c,d=new bmoor.defer.Group;for(b in a)c=a[b],">"===c.charAt(0)&&(c=c.substr(1).split(">"),a[b]="-"+c[0],d.add(this.get(c[0],!0,c[1])));return d.run(),d.promise.then(function(){return bMoor.translate(a)})}function b(b,c,d){var e;if(bMoor.isFunction(b))e=b,b=[];else{if(!bMoor.isArray(b))throw"inject needs arr to be either Array or Function";b=b.slice(0),e=b.pop()}return a.call(this,b,c).then(function(a){return bMoor.request(a).then(function(){return e.apply(d,a)})})}return{singleton:!0,properties:{forceSync:!1,get:function(a,b,c){var d;return d=bMoor.exists(a),d?b===!1?d:d.$.defer?d.$.promise:bMoor.dwrap(d):(d=new bmoor.comm.Script(c||bMoor.ns.locate(a)+".js",this.forceSync?!1:b),b===!1?bMoor.exists(a):d.$.promise.then(function(){var b=bMoor.exists(a);return b.$.defer?b.$.promise:b}))},hash:function(a){var b,c=bmoor.defer.Group();for(b in a)c.add(this.get(b,!0,a[b]));c.run()},list:function(a){var b,c,d=bmoor.defer.Group();for(b=0,c=a.length;c>b;b++)d.add(this.get(a[b]));d.run()}},plugins:{require:function(a,b){var c;return this.forceSync=!0,c=this.get(a,!1,b),this.forceSync=!1,c},"require.translate":a,"require.inject":b}}}),function(a){"use strict";bMoor.define("bmoor.comm.Resource",{construct:function(a,b){var c=this;this.$.defer=new bmoor.defer.Basic,new bmoor.comm.Http({method:"GET",url:a,async:b}).$.promise.then(function(a){try{c.status=200,c.success(c.apply(a))}catch(b){c.status=17003,c.failure(b)}},function(a,b){c.status=b,c.failure(a)})},properties:{apply:function(a){return a},success:function(a){this.status=this.status||200,this.resolve(a)},failure:function(a){this.status=this.status||19129,this.resolve(a)},resolve:function(b){200===this.status?this.$.defer.resolve({data:b,status:this.status,headers:a}):this.$.defer.reject({data:b,status:this.status,headers:a})}}})}(),function(){bMoor.define("bmoor.comm.Script",{parent:"bmoor.comm.Resource",properties:{apply:function(a){var b=document.createElement("script");b.text=a,document.body.appendChild(b)}}})}(),function(){bMoor.define("bmoor.comm.Style",{parent:"bmoor.comm.Resource",properties:{apply:function(a){var b=document.createElement("style");b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a)),document.body.appendChild(b)}}})}(),bMoor.define("bmoor.core.Collection",[function(){return{parent:"Array",traits:["bmoor.core.Model"],construct:function(a){this.merge(this.inflate(a))},properties:{simplify:function(){return this.deflate().slice(0)}}}}]),bMoor.define("bmoor.core.CollectionObserver",[function(){return{parent:"bmoor.core.MapObserver",construct:function(a){this["bmoor.core.MapObserver"]._construct.call(this,a),this.removals=[],this.watches=[],this.changes={moves:[],removals:[]},this._wrapCollection(a)},properties:{_wrapCollection:function(a){var b=this;a.pop=function(){var a=Array.prototype.pop.call(this);return void 0===a.$markRemoval&&(a.$markRemoval=b.removals.length),b.removals.push(a),a},a.shift=function(){var a=Array.prototype.shift.call(this);return void 0===a.$markRemoval&&(a.$markRemoval=b.removals.length),b.removals.push(a),a},a.splice=function(){var a,c,d=Array.prototype.splice.apply(this,arguments);for(a=0,c=d.length;c>a;a++)void 0===d[a].$markRemoval&&(d[a].$markRemoval=b.removals.length+a);return b.removals=b.removals.concat(d),d}},watchChanges:function(a){this.watches.push(a)},check:function(){var a=this;this.checking||(this["bmoor.core.MapObserver"].check.call(this),this.checking=!0,this.changes=this.checkChanges(),this._needNotify(this.changes)&&bMoor.loop(this.watches,function(b){b(a.changes)}),this.checking=!1)},checkChanges:function(){var a,b,c,d=this.model,e={},f=(this.cleaned,{});for(c in d)if(d.hasOwnProperty(c)&&"_"!==c[0]){if(b=d[c],"function"==typeof b)continue;a=parseInt(c,10),isNaN(a)||(b._co||(b._co={}),b.$remove?this.model.splice(a,1):void 0===b._co.index?f[c]=b:b._co.index!=a&&(f[c]=b,void 0!==b.$markRemoval&&(this.removals[b.$markRemoval]=void 0,delete b.$markRemoval)),b._co.index=a)}return e.removals=this.removals,e.moves=f,this.removals=[],e},_needNotify:function(a){var b;for(b in a)if(a.hasOwnProperty(b))if("removals"==b){if(a.removals.length)return!0}else{if("moves"!=b)return!0;if(!bMoor.isEmpty(a.moves))return!0}return!1}}}}]),bMoor.define("bmoor.core.Decorator",[function(){function a(a,b,c){var d=typeof c,e=b[a];"function"==d?b[a]=function(){var a,b=this._wrapped;return this.$wrapped=e,a=c.apply(this,arguments),this.$wrapped=b,a}:"string"==d&&(b[a]+=" "+c)}return{onMake:function(){var b=this,c=new b;b.$wrap=function(b){var d;for(d in c)"_construct"!==d&&(b[d]?a(d,b,c[d]):b[d]=c[d])}}}}]),function(){bMoor.define("bmoor.core.Interval",{singleton:!0,construct:function(){this._c=0,this.timeouts={},this.hash={}},properties:{set:function(a,b){var c,d=this.timeouts[b],e=this._c++;return d||(d=this.timeouts[b]={_c:0},bMoor.testMode||(d._hk=setInterval(function(){bMoor.iterate(d,function(a){a()})},b))),c=d._c++,d[c]=a,this.hash[e]={hk:d._c,val:b},e},flush:function(){bMoor.iterate(this.timeouts,function(a){bMoor.iterate(a,function(a){a()})})},clear:function(a){var b=this.hash[a];b&&(delete this.timeouts[b.val][b.hk],delete this.hash[a])}},plugins:{setInterval:"set",clearInterval:"clear"}})}(),bMoor.define("bmoor.core.Map",[function(){return{traits:["bmoor.core.Model"],construct:function(a){this._merge(this._inflate(a))},properties:{_simplify:function(){var a,b={},c=this.deflate();for(a in c)c.hasOwnProperty(a)&&"$"!==a.charAt(0)&&(b[a]=c[a]);return b},toJson:function(){return JSON.stringify(this._simplify())}}}}]),bMoor.define("bmoor.core.MapObserver",["bmoor.core.Interval",function(a){var b=0,c={};return{construct:function(d){0===b&&a.$instance.set(function(){bMoor.iterate(c,function(a){a.check()})},30),this.$snapMO=b++,this.checking=!1,this.watching={},this.observe(d),this.start()},properties:{observe:function(a){this.model&&delete this.model.$observers[this.$snapMO],this.model=a,a.$observers||(a.$observers={}),a.$observers[this.$snapMO]=this},watch:function(a,b){var c,d;this.watching[a]||(c=a.split("."),this.watching[a]={path:c,value:this.evaluate(c),calls:[]}),d=this.watching[a],b(d.value,void 0),d.calls.push(b)},evaluate:function(a){var b,c,d=this.model;for(bMoor.isString(a)&&(a=a.split(".")),b=0,c=a.length;c>b&&void 0!==d;b++)d=d[a[b]];return d},check:function(){var a=this;this.checking=!0,bMoor.iterate(this.watching,function(b){var c,d,e=a.evaluate(b.path);if(e!==b.value){for(c=0,d=b.calls.length;d>c;c++)b.calls[c](e,b.value);b.value=e}}),this.checking=!1},start:function(){c[this.$snapMO]=this},stop:function(){delete c[this.$snapMO]}}}}]),bMoor.define("bmoor.core.Model",[function(){function a(c,d){var e,f,g;for(e in c)c.hasOwnProperty(e)&&(f=c[e],g=d[e],void 0===g?d[e]=f:angular.isArray(f)?(angular.isArray(g)||(g=d[e]=[]),b(f,g)):angular.isObject(f)?(angular.isObject(g)||(g=d[e]={}),a(f,g)):f!=g&&(d[e]=f));for(e in d)d.hasOwnProperty(e)&&void 0===c[e]&&delete d[e];return d}function b(c,d){var e,f,g,h;for(e=0,f=c.length;f>e;e++)g=c[e],h=d[e],void 0===h?d[e]=g:angular.isObject(g)?(angular.isObject(h)||(h=d[e]={}),a(g,h)):angular.isArray(g)?(anguar.isArray(h)||(h=d[e]=[]),b(g,h)):g!==h&&(d[e]=g);for(e=f,f=d.length;f>e;e++)d.pop()}return{parent:"bmoor.core.Trait",properties:{_merge:function(c){return bMoor.isArray(c)?b(c,this):a(c,this),this},_validate:function(){return null},_inflate:function(a){return a},_deflate:function(){return this},_update:function(a){this._merge(a,this)},_simplify:function(){return this._deflate()},toJson:function(){return JSON.stringify(this._simplify())}}}}]),bMoor.define("bmoor.core.Service",[function(){function a(a,c){var d,e;return c.success&&(d=function(){return c.success.apply(a,arguments)}),c.failure&&(e=function(){return c.failure.apply(a,arguments)}),function(){var f,g,h,i,j,k=arguments;return bMoor.isString(c)&&(c={url:c}),c.massage&&(k[k.length-1]=c.massage.apply(a,k)),(!c.validation||c.validation.apply(a,k))&&(h=bMoor.isFunction(c.url)?c.url.apply(a,k):c.url,c.cached&&b[h]?j=b[h]:(i=k[k.length-1],c.request?(j=new bmoor.defer.Basic,f=[c.request.call(a,i),200],f.$inject=!0,j.resolve(f),j=j.promise):(g=bMoor.get(c.http||"bmoor.comm.Http"),j=new g({url:h,headers:c.headers,method:c.type||"GET",responseType:c.responseType}).$.promise),c.cached&&(b[h]=j))),j.then(d,e)}}var b={};return{onMake:function(b){var c=this;bMoor.iterate(b.services,function(b,d){c.prototype[d]=a(c,b)})}}}]),bMoor.define("bmoor.core.Trait",{onMake:function(){var a=this,b=new a;a.$wrap=function(a){var c;for(c in b)a[c]||(a[c]=b[c])}}}),bMoor.define("bmoor.error.Basic",["@undefined",function(a){return{parent:"Error",construct:function(b,c,d){var e,f;try{throw new Error}catch(g){f=g}this.name=this.__class,this.error=b,this.fileName=c,this.lineNumber=d,this.problem=a,f.stack&&(e=f.stack.split("\n"),"Error"===e[0]?(e.shift(),e.shift(),e.shift()):(e.pop(),e.shift(),e.shift()),this.problem=e[0],this.stack=e.join("\n")),this.message=b+"\n"+this.stack},properties:{toString:function(){return this.name+": "+this.message}}}}]);