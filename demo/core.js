;(function(){
/** bmoor v0.1.2 **/
var bMoor={};!function(r){"use strict";function t(){return++cr}function e(r){var e=r.$$bmoorUid;return e||(e=r.$$bmoorUid=t()),e}function n(r){return r.$$bmoorUid}function o(r){return r?A(r)?r.split("."):hr(r)?r.slice(0):r:[]}function i(r,t,e){var n,i,u,f=e||ar;if(r&&(A(r)||L(r))){r=o(r),i=r.pop();for(var s=0;s<r.length;s++)u=r[s],f[u]||(f[u]={}),f=f[u];n=f[i],f[i]=t}return n}function u(r,t){var e,n,i,u=t||bMoor.namespace.root;if(r&&(A(r)||L(r))){r=o(r),n=r.pop();for(var f=0;f<r.length;f++)i=r[f],u[i]||(u[i]={}),u=u[i];e=u[n],delete u[n]}return e}function f(r,t){var e,n=t||bMoor.namespace.root;if(r&&(A(r)||L(r))){r=o(r);for(var i=0;i<r.length;i++)e=r[i],n[e]||(n[e]={}),n=n[e];return n}if(x(r))return r;throw new Error("unsupported type")}function s(r,t){var e=t||bMoor.namespace.root;if(A(r)||L(r)){r=o(r);for(var n=0;n<r.length;n++){var i=r[n];if(!e[i])return void 0;e=e[i]}return e}if(x(r))return r;throw new Error("unsupported type")}function c(r,t){var e,n,o;if(L(t)&&t.length>0){for(e=0,n=t.length;n>e&&!o;e++)o=s(r,t[e]);return o}return s(r,t)}function a(r,t,e){var n;e?(e.$aliases||(e.$aliases={}),n=e.$aliases):n=lr,n[r]=t}function l(r,t){var e;return t?(t.$aliases||(t.$aliases={}),e=t.$aliases):e=lr,e[r]}function h(r,t){i(r,t,bMoor)}function d(r,t,e){var n,o,i;if(A(r)&&(r=f(r,e)),i="return new obj(",arguments.length>1)for(n=0,o=t.length;o>n;n++)n&&(i+=","),i+="args["+n+"]";return i+=")",new Function("obj","args",i)(r,t)}function p(r,t){return t||(t={}),Q(r,function(r,e){i(e,r,t)}),t}function v(r){return r.prototype&&(r=r.prototype),g(r)}function g(r){if(Object.create){var t=function(){};return t.prototype=r,new t}return Object.create(r)}function b(r){return U(arguments,function(t){t!==r&&(r&&r.extend?r.extend(t):Q(t,function(t,e){r[e]=t}))}),r}function m(r){var t,e,n,o=function(t,e){r[e]=m(r[e],t)};for(e=1,n=arguments.length;n>e;e++)t=arguments[e],r!==t&&t&&(r&&r.merge?r.merge(t):x(r)?S(t,o):r=x(t)?m({},t):t);return r}function y(r,t,e){return S(t,function(t,n){var o=r[n];void 0===o&&(!e||t&&t.$constructor)?r[n]=t:bMoor.isArrayLike(t)?(bMoor.isArrayLike(o)||(o=r[n]=[]),w(o,t,e)):bMoor.isObject(t)?(bMoor.isObject(o)||(o=r[n]={}),y(o,t,e)):t!==o&&(r[n]=t)}),S(r,function(e,n){void 0===t[n]&&delete r[n]}),r}function w(r,t,e){var n,o,i,u;for(L(r)&&L(t)&&(r.length=t.length),n=0,o=t.length;o>n;n++)i=t[n],u=r[n],void 0!==u||e?bMoor.isArrayLike(i)?(bMoor.isArrayLike(u)||(u=r[n]=[]),w(u,i,e)):bMoor.isObject(i)?(bMoor.isObject(u)||(u=r[n]={}),y(u,i,e)):i!==u&&(r[n]=i):r[n]=i;return r}function j(r,t){var e,n,o,i=typeof r,u=typeof t;if(r===t)return!0;if(r!==r&&t!==t)return!0;if(null===r||void 0===r||null===t||void 0===t)return!1;if(r.equals)return r.equals(t);if(t.equals)return t.equals(r);if(i===u&&"object"===i)if(L(r)){if(!L(t))return!1;if((e=r.length)===t.length){for(n=0;e>n;n++)if(!j(r[n],t[n]))return!1;return!0}}else if(!L(t)){o={};for(n in r)if(r.hasOwnProperty(n)){if(!j(r[n],t[n]))return!1;o[n]=!0}for(n in t)if(t.hasOwnProperty(n)&&!o&&void 0!==t[n])return!1}return!1}function M(r){r.message?(console.log(r.message),console.log(r.stack)):(console.log(r),console.trace())}function $(r){return void 0===r}function k(r){return void 0!==r}function A(r){return"string"==typeof r}function O(r){return"number"==typeof r}function E(r){return"function"==typeof r}function x(r){return r&&"object"==typeof r}function q(r){return"boolean"==typeof r}function L(r){return r?x(r)&&(0===r.length||0 in r&&r.length-1 in r):!1}function I(r){return"function"==typeof r&&r.$isQuark}function P(r){var t;if(!x(r))return L(r)?0===r.length:$(r);for(t in r)if(r.hasOwnProperty(t))return!1;return!0}function F(r){return x(r)&&void 0!==r.then}function N(r){return hr(r)&&E(r[r.length-1])}function U(r,t,e){var n,o;for(e||(e=r),n=0,o=r.length;o>n;++n)n in r&&t.call(e,r[n],n,r)}function D(r,t,e){var n;e||(e=r);for(n in r)r.hasOwnProperty(n)&&t.call(e,r[n],n,r)}function Q(r,t,e){var n;e||(e=r);for(n in r)r.hasOwnProperty(n)&&"_"!==n.charAt(0)&&t.call(e,r[n],n,r)}function S(r,t,e){var n;e||(e=r);for(n in r)r.hasOwnProperty(n)&&"_"!==n.charAt(0)&&"$"!==n.charAt(0)&&t.call(e,r[n],n,r)}function B(r,t,e){r&&(r.forEach&&r.forEach!==B?r.forEach(t,e):L(r)?U(r,t,e):E(r)?Q(r,t,e):D(r,t,e))}function C(r){var t;return I(r)?r.$getDefinition():x(r)&&r.then?r:(t=new nr,t.resolve(r),t.promise)}function H(r){var t;return t=new nr,t.reject(r),t.promise}function _(r,t){var e,n=o(r),u=c(n),f=function(){throw new Error("You tried to construct a Quark: "+n.join("."))};return I(u)?u:(t=t||bMoor.namespace.root,f.$isQuark=!0,nr&&(f.$getDefinition=function(){return e=new nr,u&&e.resolve(u()),e.promise},f.$set=function(r){n&&i(n,r,t),e&&e.resolve(r)},f.$setDefinition=function(r){u=function(){return C(r()).then(function(r){return n&&i(n,r,t),r})},e&&e.resolve(u())}),i(n,f,t),f)}function G(r,t,e){var n=c(r,t,e);return n?C(n):_(r,t).$getDefinition()}function Y(r,t){var e=r.charAt(0);return"@"===e?l(r.substr(1),t):"-"===e?c(r.substr(1),t):("+"===e&&(r=r.substr(1)),G(r,t))}function z(r,t){var e=[];return U(r,function(r,n){e[n]=A(r)?bMoor.decode(r,t):r}),e}function J(r,t,e){var n;return A(r)?G(r,e):L(r)?(n=new or,U(r,function(o,i){t&&A(o)&&(o=G(o,e)),F(o)?(o.then(function(t){r[i]=t}),n.add(o)):r[i]=o}),n.run(),n.promise.then(function(){return r})):void 0}function K(r,t,e){var n;if(E(r))n=r,r=[];else{if(!N(r))throw new Error("inject needs arr to be either Injectable or Function, received:"+typeof r);n=r[r.length-1]}return e||(e=bMoor),J(z(r,t),!1,t).then(function(r){return n.apply(e,r)})}function R(r){var t=r,e=document.createElement("a");return fr&&(e.setAttribute("href",t),t=e.href),e.setAttribute("href",t),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}function T(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function V(r,t,e){if(r.indexOf)return r.indexOf(t,e);var n=parseInt(r.length,0);for(e=+e||0,Math.abs(e)===1/0&&(e=0),0>e&&(e+=n,0>e&&(e=0));n>e;e++)if(r[e]===t)return e;return-1}function W(r,t,e){var n=V(r,t,e);return n>-1?r.splice(n,1)[0]:void 0}function X(r,t,e){var n,o=V(r,t,e);return o>-1?(n=X(r,t,o+1),n.unshift(r.splice(o,1)[0]),n):[]}function Z(r,t,e,n){var o,i,u=0,f=r.length-1;if(n||r.sort(function(r,t){return e(r)-e(t)}),e(r[u])>=t)return{left:u,right:u};if(e(r[f])<=t)return{left:f,right:f};if(r.length){for(;f-u>1;)o=Math.floor((f+u)/2),i=e(r[o]),i===t?(f=o,u=o):i>t?f=o:u=o;return f!==o&&e(r[f])===t?{left:f,right:f}:u!==o&&e(r[u])===t?{left:u,right:u}:{left:u,right:f}}}function rr(r,t,e){if(r.filter)return r.filter(t,e);var n,o,i=Object(this),u=parseInt(i.length,10),f=[];if(!E(t))throw new Error("func needs to be a function");for(n=0;u>n;n++)n in i&&(o=i[n],t.call(e,o,n,i)&&f.push(o));return f}function tr(r,t,e){var n,o=[],i=[],u=[],f=[];for(r=r.slice(0),t=t.slice(0),r.sort(e),t.sort(e);r.length>0&&t.length>0;)n=e(r[0],t[0]),0>n?o.push(r.shift()):n>0?i.push(t.shift()):(u.push(r.shift()),f.push(t.shift()));for(;r.length;)o.push(r.shift());for(;t.length;)i.push(t.shift());return{left:o,intersection:{left:u,right:f},right:i}}function er(r){this.defer=r}function nr(r){this.handler=r||this.defaultHandler,this.callbacks=[],this.value=null,this.promise=new er(this)}function or(){this.count=0,this.loaded=!1,this.errors=[],this.defer=new nr,this.promise=this.defer.promise}function ir(r){var t=s(r);return I(t)?void 0:t}function ur(r){var t=ir(r);if($(t))throw new Error(r+" was required, but could not be found");return t}var fr,sr,cr=0,ar={},lr={};r.navigator?(r.bMoor=bMoor,fr=parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1],10),isNaN(fr)&&(fr=parseInt((/trident\/.*; rv:(\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1],10)),sr={isNode:!1,msie:fr}):(module.exports=bMoor,sr={isNode:!0});var hr=function(r){return r instanceof Array};K.getInjections=function(r){return N(r)?r.slice(0,-1):[]},a("undefined",void 0),i("bmoor.defer.Promise",er),b(er.prototype,{then:function(r,t){function e(t){try{i.resolve((r||o.defaultSuccess).call(i,t))}catch(e){i.reject(e),o.handler(e)}}function n(r){try{i.resolve((t||o.defaultFailure).call(i,r))}catch(e){i.reject(e),o.handler(e)}}var o=this.defer,i=this.defer.sub();return o.register(e,n),i.promise},"catch":function(r){return this.then(null,r)},done:function(r){return this.then(r),this},fail:function(r){return this.then(null,r),this},"finally":function(r){function t(r,t){var e=new nr;return t?e.resolve(r):e.reject(r),e.promise}function e(e,o){var i=null;try{i=(r||n.defaultSuccess)()}catch(u){return t(u,!1)}return i&&bMoor.isFunction(i.then)?i.then(function(){return t(e,o)},function(r){return t(r,!1)}):t(e,o)}var n=this;return this.then(function(r){return e(r,!0)},function(r){return e(r,!1)})},always:function(r){return this["finally"](r),this}}),i("bmoor.defer.Basic",nr),function(){function r(r){return r&&r.then?r:{then:function(t){bMoor.isArrayLike(r)&&r.$inject?t.apply(void 0,r):t(r)}}}function t(r){return{then:function(t,e){e(r)}}}b(nr.prototype,{defaultHandler:function(r){bMoor.error.report(r)},defaultSuccess:function(r){this.resolve(r)},defaultFailure:function(r){this.reject(r)},register:function(r,t){this.callbacks?this.callbacks.push([r,t]):this.value.then(r,t)},resolve:function(t){var e,n,o,i;if(this.callbacks)for(e=this.callbacks,this.callbacks=null,this.value=r(t),o=0,i=e.length;i>o;o++)n=e[o],this.value.then(n[0],n[1])},reject:function(r){this.resolve(t(r))},sub:function(){return new nr(this.handler)}})}(),i("bmoor.defer.Group",or),function(){function r(r){0===r.count&&r.loaded&&(r.errors.length?r.defer.reject(r.errors):r.defer.resolve(!0))}function t(t){t.count--,r(t)}b(or.prototype,{add:function(r){var e=this;r&&(this.count++,r.then(function(){t(e)},function(r){e.errors.push(r),t(e)}))},run:function(){this.loaded=!0,r(this)}})}(),i("bmoor.defer.all",function(){var r,t=new or;return r=O(arguments[0].length)?arguments[0]:arguments,bMoor.forEach(r,function(r){t.add(r)}),t.run(),t.promise}),b(bMoor,{namespace:{root:ar},parseNS:o,dwrap:C,dfail:H,set:i,get:f,del:u,exists:c,register:a,check:l,makeQuark:_,ensure:G,decode:Y,request:J,translate:z,inject:K,plugin:h,require:ur,include:ir,loop:U,each:D,iterate:Q,forEach:B,isBoolean:q,isDefined:k,isUndefined:$,isArray:hr,isArrayLike:L,isObject:x,isFunction:E,isNumber:O,isString:A,isInjectable:N,isEmpty:P,isQuark:I,data:{setUid:e,getUid:n},object:{safe:S,mask:g,equals:j,instantiate:d,inherit:v,extend:b,merge:m,override:y,explode:p},string:{trim:T},array:{compare:tr,indexOf:V,remove:W,removeAll:X,filter:rr,override:w,bisect:Z},error:{report:M},url:{resolve:R}})}(this);
}());